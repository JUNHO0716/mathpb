<!DOCTYPE html>
<html lang="ko">
<head>
  <meta name="robots" content="noindex, nofollow">
  <meta charset="UTF-8">
  <title>íšŒì› ì •ë³´</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700;900&display=swap" rel="stylesheet">
  <!-- Swiper ê´‘ê³ ë°°ë„ˆìš© -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.css">
  <link rel="stylesheet" href="footer.css">
  <style>

body {
  margin: 0; background: #fff;
  font-family: 'Noto Sans KR', sans-serif;
}

 /* ğŸ”¶ íƒ‘ ê´‘ê³ ë°°ë„ˆ ìŠ¤íƒ€ì¼ */
.top-banner {
  width: 100%;
  height: 400px;
  overflow: hidden;
  border-bottom: 1px solid #eee;
}
.topSwiper,
.topSwiper .swiper-wrapper,
.topSwiper .swiper-slide {
  width: 100%;
  height: 100%;
}
.topSwiper .swiper-slide img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  opacity: 0;
  transition: opacity 0.5s ease;
}
.topSwiper .swiper-slide img.loaded {
  opacity: 1;
}
.topSwiper .swiper-pagination {
  display: none !important;
}

  /* â–£ ëª¨ë‹¬ */
  .modal{position:fixed;inset:0;display:none;align-items:center;
        justify-content:center;background:rgba(0,0,0,.55);z-index:100;}
  .modal-content{max-width:580px;width:90%;background:#fff;border-radius:12px;
                padding:32px 28px;text-align:center;position:relative;}
  .modal-content img{max-width:100%;height:auto;border-radius:10px;}
  .modal-content p{margin-top:18px;font-size:1.05rem;line-height:1.6;}
  .modal-close{position:absolute;right:18px;top:14px;font-size:1.8rem;
              border:none;background:none;color:#555;cursor:pointer;}
  .modal-close:hover{color:#000;}

  .page-header::after{
  content:'';
  position:absolute;
  left:50%;                          /* ê°€ìš´ë° ê¸°ì¤€ */
  bottom:0;                          /* í—¤ë” ë§¨ ì•„ë˜ */
  transform:translateX(-50%);        /* ì •í™•í•œ ì¤‘ì•™ ì •ë ¬ */

  width:97%;                         /* â† ê¸¸ì´(=ì–‘ìª½ ì—¬ë°±) ì¡°ì ˆ í¬ì¸íŠ¸ */
  height:1px;                        /* ì„  êµµê¸° */
  background:var(--border-light);    /* ì„  ìƒ‰ìƒ */
  }
    /* â”€â”€â”€ ì¹´ë“œ ê°€ë¡œ ìŠ¤í¬ë¡¤ í–‰ â”€â”€â”€ */
    .h-scroll        {position:relative;margin:32px 40px;}
    .h-scroll .inner {display:flex;gap:16px;overflow-x:auto;
                      padding:12px 0;scroll-behavior:smooth;}
    .h-scroll .inner::-webkit-scrollbar{display:none;}

    .card-item{
      flex:0 0 210px;                 /* ì¹´ë“œ í­ */
      height:120px;
      border-radius:14px;
      background:#f7f8f9;
      box-shadow:0 2px 6px rgba(0,0,0,.04);
      display:flex;justify-content:center;align-items:center;
      font-weight:700;color:#333;
    }
    .my-desc{ display:none; }
    .modal-content iframe{
      width:100%;
      height:70vh;           /* ì›í•˜ëŠ” ë†’ì´ ë¹„ìœ¨ */
      border:0;
      border-radius:12px;
    }
.dashboard-body {
  display: flex;
  flex-wrap: wrap;
  gap: 20px;
  margin: 28px 40px 80px;
}
.user-row {
  width: 340px;
  flex-shrink: 0;
  display: flex;
  flex-direction: column;
  gap: 20px;
}
.profile-card {
  width: 280px;
  min-height: 520px;  /* ë‚´ ë¬¸ì œì§€ ì¹´ë“œì™€ ë†’ì´ ë™ì¼í•˜ê²Œ! */
  background: #fff;
  border: 1px solid #e9e9e9;
  border-radius: 22px;
  box-shadow: 0 4px 12px rgba(0,0,0,.04);
  padding: 0 28px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center; /* ìˆ˜ì§/ìˆ˜í‰ ì™„ì „ ì¤‘ì•™ */
}
.profile-center {
  display: flex;
  flex-direction: column;
  align-items: center;
}
.avatar-label {
  display: flex;
  flex-direction: column;
  align-items: center;
  cursor: pointer;
  gap: 10px;
}

.change-photo-btn {
  background: #f7f8fa;
  border: 1px solid #ccc;
  border-radius: 9999px;
  padding: 4px 18px;
  font-size: 0.95rem;
  color: #333;
  cursor: pointer;
  margin-top: 2px;
  transition: background .15s, color .15s;
}
.change-photo-btn:hover {
  background: #f0e9ff;
  color: #6c4fc8;
}

.profile-card img {
  width: 74px;
  height: 74px;
  border-radius: 50%;
  object-fit: cover;
}
.profile-card .info {
  text-align: center;
  margin-top: 18px;
}
.profile-card .info h3 {
  font-size: 1.1rem;
  font-weight: 900;
  color: #111;
}
.profile-card .info .role {
  margin-top: 3px;
  font-size: .98rem;
  color: #5f5f5f;
}
.mysheet-board {
  flex: 1 1 420px;
  background: #fff;
  border: 1px solid #e9e9e9;
  border-radius: 22px;
  box-shadow: 0 4px 12px rgba(0,0,0,.04);
  padding: 28px;
  min-height: 420px;
}
.mysheet-board h2 {
  font-size: 1.25rem;
  font-weight: 900;
  margin-bottom: 22px;
}

.grade-label {
  font-weight: 900;
  padding: 3px 16px;
  border-radius: 10px;
  font-size: 1.08rem;
}
.grade-gold   { color: #c09619; background: #fff7c3; }
.grade-silver { color: #6a7a8b; background: #f0f4f7; }
.grade-bronze { color: #be7625; background: #ffe7ce; }

.info.loading *, .member-info.loading * {
  visibility: hidden;
}

.member-info > div {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 14px;
}
.member-info label {
  width: 120px;
  font-weight: 600;
}

.mysheet-board {
  border-radius: 20px;
  padding: 32px;
  background: #fff;
  box-shadow: 0 4px 16px rgba(0,0,0,0.05);
}

#profileAvatar {
  width: 120px;         /* ê¶Œì¥: 80~120px (ì¶”ì²œê°’ì€ 96px) */
  height: 120px;
  border-radius: 50%;
  object-fit: cover;
  background: #eaeaea;
  margin-bottom: 8px;
  border: 2px solid #eee;
  transition: filter .2s;
  margin-bottom: 8px; 
  margin-top: -120px; 
  margin-bottom: 30px;  
}
#profileAvatar:hover { filter: brightness(0.95); }

.change-photo-btn {
  background: #f7f8fa;
  border: 1px solid #ccc;
  border-radius: 9999px;
  padding: 4px 18px;
  font-size: 0.95rem;
  color: #333;
  cursor: pointer;
  margin-top: 2px;
  transition: background .15s, color .15s;
}

  /* [NEW] í”„ë¡œí•„ ì‚¬ì§„ í˜ì´ë“œ-ì¸ */
  #profileAvatar{
    opacity:0;                       /* ì²˜ìŒì—” íˆ¬ëª… */
    transition:opacity .6s ease;     /* 0.6ì´ˆ ë™ì•ˆ ë¶€ë“œëŸ½ê²Œ */
  }
  #profileAvatar.fade-in{opacity:1;} /* í´ë˜ìŠ¤ ë¶™ìœ¼ë©´ ë‚˜íƒ€ë‚¨ */

button {
  background: #6366f1;
  color: white;
  border: none;
  padding: 10px 18px;
  border-radius: 8px;
  font-weight: 600;
  cursor: pointer;
  transition: background 0.2s;
}
button:hover {
  background: #4f46e5;
}

input[type="text"],
input[type="password"],
input[type="email"] {
  width: 100%;
  padding: 12px 14px;
  border: 1px solid #ddd;
  border-radius: 8px;
  font-size: 1rem;
  transition: border 0.2s;
}
input:focus {
  border-color: #6366f1;
  outline: none;
}

    .member-info-row {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 14px;
    }
    .member-info-label {
      width: 120px;
      font-weight: 600;
      font-size: 1rem;
      color: #111;
    }
    .member-info-input {
      flex: 1;
      padding: 8px 12px;
      border: 1px solid #ddd;
      border-radius: 6px;
      background: #f7f7f9;
      font-size: 1rem;
    }
    .member-info-value {
      flex: 1;
      font-size: 1rem;
      color: #333;
    }
    /* â”€â”€ ë¹„ë°€ë²ˆí˜¸ í™•ì¸/ë³€ê²½ ë²„íŠ¼ â”€â”€ */
    .pw-btn {
      padding: 6px 14px;
      border: none;
      border-radius: 6px;
      background: #6366f1;
      color: #fff;
      font-size: 0.95rem;
      cursor: pointer;
      transition: background 0.2s;
    }
    .pw-btn:hover {
      background: #4f46e5;
    }

    /* ID inputë§Œ ì¢ê²Œ */
#mem-id-input {
  /* ì›í•˜ëŠ” ê°€ë¡œ ë„“ì´(px ë‹¨ìœ„) */
  width: 250px;    
  /* ë†’ì´ë„ ì¡°ì ˆ ê°€ëŠ¥ */
  height: 28px;    
  /* padding-top/bottomì„ ì¤„ì´ë©´ ë†’ì´ê°€ ë” ì‘ì•„ì§‘ë‹ˆë‹¤ */
  padding: 4px 8px; 
  /* í•„ìš”í•˜ë©´ font-sizeë„ ì¡°ì ˆ */
  font-size: 0.95rem;
  
  /* flex:1 ëŒ€ì‹  noneìœ¼ë¡œ í•´ì œí•˜ë©´ ê³ ì •í­ì´ ì •í™•íˆ ì ìš©ë©ë‹ˆë‹¤ */
  flex: none;      
}

#current-password,
#new-password,
#confirm-password {
  width: 184px;       /* ì›í•˜ëŠ” ë„ˆë¹„(px) */
  height: 28px;       /* ì›í•˜ëŠ” ë†’ì´(px) */
  padding: 4px 8px;   /* ìƒí•˜/ì¢Œìš° ì—¬ë°± */
  font-size: 0.95rem; /* í°íŠ¸ í¬ê¸° */
  flex: none;         /* flex-grow ë¹„í™œì„±í™”í•´ì„œ ê³ ì •í­ ì ìš© */
}



:root {
  /* ë²„íŠ¼ìš© ì»¤ìŠ¤í…€ í”„ë¡œí¼í‹° */
  --btn-bg:       #6366f1;
  --btn-bg-hover: #4f46e5;
  --btn-color:    #fff;
  --btn-radius:   6px;
  --btn-padding:  6px 16px;
  --btn-font:     0.95rem 'Noto Sans KR', sans-serif;
  --btn-shadow:   0 2px 6px rgba(0,0,0,0.15);
}

.pw-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: var(--btn-padding);
  background-color: var(--btn-bg);
  color: var(--btn-color);
  font: var(--btn-font);
  border: none;
  border-radius: var(--btn-radius);
  box-shadow: var(--btn-shadow);
  cursor: pointer;
  transition:
    background-color 0.2s ease,
    transform        0.1s ease;
}

.pw-btn:hover {
  background-color: var(--btn-bg-hover);
}

.pw-btn:active {
  transform: scale(0.97);
}

/* ë ˆì´ë¸” ë’¤ì— ì½œë¡  ì¶”ê°€ + ê°„ê²© í†µì¼ */
.member-info-label::after {
  content: ":";
  margin-right: 8px;
}

/* .member-info-row ì— ì´ë¯¸ align-items:center; ê°€ ìˆìœ¼ë‹ˆ ê·¸ëŒ€ë¡œ ì‚¬ìš© */

/* grade-label (êµ¬ë… ìƒíƒœ) ë†’ì´, íŒ¨ë”© ì¡°ì •í•´ì„œ ë‹¤ë¥¸ í•­ëª©ê³¼ ë§ì¶”ê¸° */
.member-info-value.grade-label {
  display: inline-flex;       /* flex ìì‹ì²˜ëŸ¼ ì·¨ê¸‰ */
  align-items: center;
  height: 32px;               /* input ë†’ì´ì™€ ë™ì¼í•˜ê²Œ */
  padding: 0 12px;            /* ì¢Œìš° íŒ¨ë”© */
  font-size: 1rem;            /* ë‹¤ë¥¸ ê°’ê³¼ í†µì¼ */
  margin-right: 0;            /* ë¶ˆí•„ìš”í•œ ì—¬ë°± ì œê±° */
}


 .subscription-inline {
  display: inline-flex;
  align-items: center;
  gap: 8px; /* â† ì—¬ê¸°ì„œ ê°„ê²© ì¡°ì ˆ ê°€ëŠ¥ (ì˜ˆ: 4px, 8px, 12px ë“±) */
}

/* êµ¬ë… ì¤„ì˜ spanì´ flex-grow í•˜ì§€ ì•Šë„ë¡ ë§‰ê¸° */
#mem-subscription {
  flex: none;
}

/* ë²„íŠ¼ì„ í…ìŠ¤íŠ¸ ë°”ë¡œ ì˜†ìœ¼ë¡œ ë‹¹ê¸°ê¸° */
#subscribeBtn {
  margin-left: 0px;  /* ì›í•˜ì‹œë©´ px ê°’ì„ ë” ì‘ê²Œ(ì˜ˆ: 6px, 4px) ì¡°ì • */
}

#mem-subscription {
  margin-left: -15px;  /* ì˜ˆ: 24px ë§Œí¼ ì˜¤ë¥¸ìª½ìœ¼ë¡œ ì´ë™ */
}

.member-info-container {
  display: flex;
  gap: 40px;
}
.member-info-col {
  flex: 1;
}

.member-info-container {
  position: relative;
}

.member-info-container::before {
  content: "";
  position: absolute;
  top: 0;
  bottom: 0;
  left: calc(47% - 20px);  /* ì›í•˜ëŠ” ìœ„ì¹˜ë¡œ ì¡°ì • */
  border-left: 1px dashed #9c9c9c;
}

/* â”€â”€â”€â”€â”€ íšŒì› ì •ë³´ ì»¬ëŸ¼ ì „ì²´ë¥¼ flex-column + gap ì ìš© â”€â”€â”€â”€â”€ */
.member-info-container .member-info-col {
  display: flex;
  flex-direction: column;
  justify-content: flex-start; /* ë§¨ ìœ„ ê³ ì • */
  gap: 20px;                   /* ì¤„ ê°„ê²© ì¡°ì ˆ (ì›í•˜ëŠ” ê°’ìœ¼ë¡œ ë³€ê²½) */
}

/* â”€â”€â”€â”€â”€ ì˜¤ë¥¸ìª½ ì»¬ëŸ¼ ì²« ë²ˆì§¸ div(í˜„ê¸ˆì˜ìˆ˜ì¦ ë˜í¼)ì˜ inline margin-top ì œê±° â”€â”€â”€â”€â”€ */
/* inline style="margin-top:18px;" ì„ ë®ì–´ì”ë‹ˆë‹¤ */
.member-info-container .member-info-col:nth-child(2) > div {
  margin-top: 0 !important;
}

.member-info-row {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 14px;
}

.member-info-label {
  width: 120px;
  font-weight: 600;
  font-size: 1rem;
  color: #111;
}

.member-info-input {
  flex: 1;
  padding: 8px 12px;
  border: 1px solid #ddd;
  border-radius: 6px;
  background: #f7f7f9;
  font-size: 1rem;
}

.pw-btn {
  padding: 6px 14px;
  border: none;
  border-radius: 6px;
  background: #6366f1;
  color: #fff;
  font-size: 0.95rem;
  cursor: pointer;
}

/* no-colon í´ë˜ìŠ¤ ë‹¬ë¦° labelì€ ::after ì½œë¡ ì´ ì—†ê²Œ */
.member-info-label.no-colon::after {
  content: "";
}



  </style>
</head>
<body>

<!-- â–£ ê´‘ê³  ìŠ¬ë¼ì´ë” â–£ -->
<section class="top-banner">
  <div class="swiper topSwiper">
    <div class="swiper-wrapper">
      <div class="swiper-slide"><img src="ad_big1.jpg" alt="íƒ‘ ë°°ë„ˆ 1"></div>
      <div class="swiper-slide"><img src="ad_big2.jpg" alt="íƒ‘ ë°°ë„ˆ 2"></div>
      <div class="swiper-slide"><img src="ad_big3.jpg" alt="íƒ‘ ë°°ë„ˆ 3"></div>
    </div>
    <div class="swiper-pagination"></div>
  </div>
</section>

<div class="dashboard-body" style="display:flex;flex-wrap:wrap;gap:20px;margin:28px 40px 80px;">
  <!-- (ì™¼ìª½) í”„ë¡œí•„ ì¹´ë“œ -->
  <div class="user-row" style="width:340px;flex-shrink:0;display:flex;flex-direction:column;gap:20px;">
    <!-- 1) í”„ë¡œí•„ ì¹´ë“œ -->
    <div class="profile-card">
      <div class="profile-center">
        <label class="avatar-label" for="profileImageInput">
          <img id="profileAvatar" alt="avatar">
          <input type="file" id="profileImageInput"
           name="avatar"  
           accept="image/*"
           style="display:none;">
          <div style="display:flex;gap:8px;">
            <button type="button" class="change-photo-btn">ì‚¬ì§„ ë³€ê²½</button>
            <button type="button" class="change-photo-btn" id="savePhotoBtn" style="display:none;">ì €ì¥</button>
            <button type="button" class="change-photo-btn" id="deletePhotoBtn">ì‚­ì œ</button>
          </div>
        </label>
        <div class="info loading">
         <h3 id="profileName">UserName</h3>
         <!-- í”„ë¡œí•„ ì¹´ë“œ í•˜ë‹¨ì— ID ì¶”ê°€ -->
         <div class="role" id="profileId">-</div>
        </div>
      </div>
    </div>
  </div>
  
 <div class="mysheet-board">
  <h2>íšŒì› ì •ë³´</h2>
  <div class="member-info">

    <!-- â˜… ì—¬ê¸°ì—ë§Œ ì¶”ê°€ -->
    <div class="member-info-container">
      
      <!-- ì™¼ìª½ ì»¬ëŸ¼: ê¸°ì¡´ ì²«ë²ˆì§¸~êµ¬ë…ê¹Œì§€ -->
      <div class="member-info-col">
        <!-- ì•„ì´ë”” -->
        <div class="member-info-row">
          <label for="mem-id-input" class="member-info-label">ID</label>
          <input type="text" id="mem-id-input" value="-" disabled class="member-info-input"/>
        </div>

        <!-- ë¹„ë°€ë²ˆí˜¸ í™•ì¸ -->
        <div id="pw-box">
          <div class="member-info-row" id="pw-check-box">
            <label class="member-info-label">ë¹„ë°€ë²ˆí˜¸ í™•ì¸</label>
            <input type="password" id="current-password" placeholder="ê¸°ì¡´ ë¹„ë°€ë²ˆí˜¸ ì…ë ¥"
                   autocomplete="new-password" class="member-info-input"/>
            <button id="pw-check-btn" class="pw-btn">í™•ì¸</button>
          </div>
          <div class="member-info-row" id="pw-change-box" style="display:none;">
            <label class="member-info-label">ìƒˆ ë¹„ë°€ë²ˆí˜¸</label>
            <input type="password" id="new-password" placeholder="ìƒˆ ë¹„ë°€ë²ˆí˜¸" class="member-info-input"/>
            <input type="password" id="confirm-password" placeholder="ë¹„ë°€ë²ˆí˜¸ í™•ì¸" class="member-info-input"/>
            <button id="pw-change-btn" class="pw-btn">ë³€ê²½</button>
          </div>
        </div>

        <!-- ì´ë©”ì¼ -->
        <div class="member-info-row">
          <label class="member-info-label">ì´ë©”ì¼</label>
          <span id="mem-email" class="member-info-value">-</span>
        </div>

        <!-- íœ´ëŒ€í° ë²ˆí˜¸ -->
        <div class="member-info-row">
          <label class="member-info-label">íœ´ëŒ€í° ë²ˆí˜¸</label>
          <span id="mem-phone" class="member-info-value">-</span>
        </div>

        <!-- êµ¬ë… -->
        <div class="member-info-row">
          <label class="member-info-label">êµ¬ë…</label>
          <span id="mem-subscription" class="member-info-value grade-label">ë¯¸êµ¬ë…</span>
          <button id="subscribeBtn" class="pw-btn subscribe-btn">êµ¬ë…í•˜ê¸°</button>
        </div>
      </div>

<!-- ì˜¤ë¥¸ìª½ ì»¬ëŸ¼ -->
<div class="member-info-col">
  <!-- 1) í˜„ê¸ˆì˜ìˆ˜ì¦ -->
  <div class="member-info-row">
  <label class="member-info-label">í˜„ê¸ˆì˜ìˆ˜ì¦ ë°œê¸‰ ë²ˆí˜¸</label>

  <!-- â‘  ì…ë ¥ì°½ -->
  <input id="mem-biz-input"
         type="text"
         placeholder="ì‚¬ì—…ì/íœ´ëŒ€í°ë²ˆí˜¸"
         class="member-info-input"
         style="width:160px;" />

  <!-- â‘¡ ì €ì¥ ë²„íŠ¼ -->
  <button id="mem-biz-save" class="pw-btn">ì €ì¥</button>

  <!-- â‘¢ ì €ì¥ í›„ ë³´ì—¬ì¤„ span -->
  <span id="mem-biz-view"
        style="display:none; margin-left:10px; color:#218155; font-weight:700;">
  </span>

  <!-- â‘£ ë³€ê²½ ë²„íŠ¼ -->
  <button id="mem-biz-edit"
          class="pw-btn"
          style="display:none; margin-left:8px;">
    ë³€ê²½
  </button>
</div>

  <!-- 2) í•™ì› ëª… -->
  <div class="member-info-row">
    <label class="member-info-label">í•™ì› ëª…</label>
    <input id="mem-academy-name"
           type="text"
           placeholder="í•™ì›ëª…"
           class="member-info-input"
           style="width:200px;" />
  </div>

  <!-- 3) í•™ì› ì£¼ì†Œ -->
  <div class="member-info-row">
    <label class="member-info-label">í•™ì› ì£¼ì†Œ</label>
    <input id="mem-academy-address-input"
           type="text"
           placeholder="í•™ì› ì£¼ì†Œ ì…ë ¥"
           class="member-info-input"
           style="flex:1;" />
    <button id="academy-address-save" class="pw-btn">ë³€ê²½</button>
  </div>

  <!-- 4) í•™ì› ë²ˆí˜¸ -->
  <div class="member-info-row">
    <label class="member-info-label">í•™ì› ë²ˆí˜¸</label>
    <input id="mem-academy-phone"
           type="text"
           placeholder="ì „í™”ë²ˆí˜¸"
           class="member-info-input"
           style="width:160px;" />
  </div>

  <!-- 5) ì €ì¥ ë²„íŠ¼ (no-colonìœ¼ë¡œ ì½œë¡  ì œê±°) -->
  <div class="member-info-row">
    <label class="member-info-label no-colon"></label>
    <button id="academy-save-btn"
            class="pw-btn"
            style="flex:1;">í•™ì› ì •ë³´ ì €ì¥</button>
  </div>
</div>

<!-- Swiper JS (ê´‘ê³ ë°°ë„ˆìš©) -->
<script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
const topSwiper = new Swiper('.topSwiper', {
  loop: true,
  autoplay: { delay: 4000 },
  effect: 'fade',
  fadeEffect: { crossFade: true },
  speed: 1000,
  allowTouchMove: false,
  simulateTouch: false,
  pagination: {
    el: '.topSwiper .swiper-pagination',
    clickable: false
  }
});

document.querySelectorAll('.topSwiper .swiper-slide img').forEach(img => {
  if (img.complete) {
    img.classList.add('loaded');
  } else {
    img.addEventListener('load', () => {
      img.classList.add('loaded');
    });
  }
});

async function setProfileInfo() {
  try {
    const res = await fetch('/check-auth?ts='+Date.now(), {
      credentials: 'include', cache:'no-store'
    });
    const d = await res.json();
    if (!d.isLoggedIn) return;
    const u = d.user;

    console.log('[u ê°ì²´]', u);
 
    document.querySelector('.info').classList.remove('loading');

     // â–· ì‚¬ìš©ì ì •ë³´ í™”ë©´ì— ë°˜ì˜
     // 1) ID
        let displayId = u.id;
        if (
          /^[0-9]{10,21}$/.test(u.id) && u.email && u.email.includes('@')
        ) {
          displayId = u.email.split('@')[0];
        }
        document.getElementById('profileId').textContent = displayId;
        document.getElementById('mem-id-input').value    = displayId;
     // 2) í”„ë¡œí•„ ì‚¬ì§„ & ì´ë¦„
     document.getElementById('profileAvatar').src       = u.avatarUrl;
     document.getElementById('profileName').textContent = u.name;
     // 3) ì´ë©”ì¼
     document.getElementById('mem-email').textContent = u.email;
     // 4) íœ´ëŒ€í° ë²ˆí˜¸
     document.getElementById('mem-phone').textContent    = u.phone;
     // 5) êµ¬ë… ìƒíƒœ
     const subLabel = document.getElementById('mem-subscription');
     const subBtn   = document.getElementById('subscribeBtn');
     if (u.hasPaid) {
       subLabel.textContent = 'êµ¬ë…ì¤‘';
       subBtn.style.display  = 'none';
     } else {
       subLabel.textContent = 'ë¯¸êµ¬ë…';
       subBtn.style.display  = 'inline-block';
     }


    // 2) í˜„ê¸ˆì˜ìˆ˜ì¦ ì´ˆê¸°í™”
    if (u.bizNum) showBizNum(u.bizNum);
    else {
      document.getElementById('mem-biz-input').style.display = 'inline-block';
      document.getElementById('mem-biz-save').style.display  = 'inline-block';
      document.getElementById('mem-biz-view').style.display  = 'none';
      document.getElementById('mem-biz-edit').style.display  = 'none';
    }

    // 3) í•™ì› ëª…/ë²ˆí˜¸ ì´ˆê¸°í™”
    const nameIn  = document.getElementById('mem-academy-name');
    const phoneIn = document.getElementById('mem-academy-phone');
    const btn     = document.getElementById('academy-save-btn');

    if (u.academyName) {
      nameIn.value    = u.academyName;
      phoneIn.value   = u.academyPhone || '';
      nameIn.disabled = phoneIn.disabled = true;
      btn.textContent = 'ë³€ê²½';
    } else {
      nameIn.value    = '';
      phoneIn.value   = '';
      nameIn.disabled = phoneIn.disabled = false;
      btn.textContent = 'ì €ì¥';
    }

    // 4) í•™ì› ì£¼ì†Œ, ë¡œë”© í•´ì œ ë“± ê¸°ì¡´ ë¡œì§ ìƒëµâ€¦

  } catch(e) {
    console.error(e);
  }
}
setProfileInfo();

// â”€â”€â”€ í˜„ê¸ˆì˜ìˆ˜ì¦ ë³´ê¸°/ì €ì¥/ë³€ê²½ â”€â”€â”€
function showBizNum(bizNum) {
  document.getElementById('mem-biz-input').style.display = 'none';
  document.getElementById('mem-biz-save').style.display  = 'none';
  const v = document.getElementById('mem-biz-view');
  v.textContent = bizNum; v.style.display = 'inline-block';
  document.getElementById('mem-biz-edit').style.display = 'inline-block';
}
document.getElementById('mem-biz-save').onclick = async () => {
  const val = document.getElementById('mem-biz-input').value.trim();
  if (!val) return alert('ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”');
  const res = await fetch('/api/update-biznum', {
    method:'POST', headers:{'Content-Type':'application/json'},
    credentials:'include', body:JSON.stringify({ bizNum:val })
  });
  const d = await res.json();
  if (d.success) { showBizNum(val); alert('ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!'); }
  else alert('ì €ì¥ ì‹¤íŒ¨');
};
document.getElementById('mem-biz-edit').onclick = () => {
  document.getElementById('mem-biz-input').style.display = 'inline-block';
  document.getElementById('mem-biz-save').style.display  = 'inline-block';
  document.getElementById('mem-biz-view').style.display  = 'none';
  document.getElementById('mem-biz-edit').style.display = 'none';
};

// â”€â”€â”€ í•™ì› ëª…/ë²ˆí˜¸ ì €ì¥ & ë³€ê²½ í† ê¸€ â”€â”€â”€
document.getElementById('academy-save-btn').onclick = async function() {
  const nameIn  = document.getElementById('mem-academy-name');
  const phoneIn = document.getElementById('mem-academy-phone');
  const btn     = this;

  if (btn.textContent === 'ì €ì¥') {
    const name  = nameIn.value.trim();
    const phone = phoneIn.value.trim();
    if (!name) return alert('í•™ì›ëª…ì„ ì…ë ¥í•˜ì„¸ìš”');
    const res = await fetch('/api/save-academy', {
      method:'POST', headers:{'Content-Type':'application/json'},
      credentials:'include', body:JSON.stringify({ name, phone })
    });
    const d = await res.json();
    if (d.success) {
      nameIn.disabled = phoneIn.disabled = true;
      btn.textContent = 'ë³€ê²½';
      alert('í•™ì› ì •ë³´ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
    } else {
      alert(d.msg || 'ì €ì¥ ì‹¤íŒ¨');
    }
  } else {
    nameIn.disabled = phoneIn.disabled = false;
    btn.textContent = 'ì €ì¥';
  }
};


document.querySelector('.change-photo-btn').onclick = function() {
  document.getElementById('profileImageInput').click();
};

let selectedFile = null;

// ì‚¬ì§„ ì„ íƒí•˜ë©´ ë¯¸ë¦¬ë³´ê¸°ë§Œ
document.getElementById('profileImageInput').addEventListener('change', function(e) {
  const file = e.target.files[0];
  if (!file) return;
  selectedFile = file;  // ì €ì¥ ë²„íŠ¼ì„ ëˆ„ë¥¼ ë•Œ ì „ì†¡í•˜ê¸° ìœ„í•´ ë³´ê´€
  // ë¯¸ë¦¬ë³´ê¸°
  const reader = new FileReader();
  reader.onload = function(evt) {
    document.getElementById('profileAvatar').src = evt.target.result;
  };
  reader.readAsDataURL(file);

  // ì €ì¥ ë²„íŠ¼ í‘œì‹œ
  document.getElementById('savePhotoBtn').style.display = 'inline-block';
});

// ì €ì¥ ë²„íŠ¼ ëˆŒëŸ¬ì•¼ ì„œë²„ì— ì—…ë¡œë“œ
document.getElementById('savePhotoBtn').addEventListener('click', async function() {
  if (!selectedFile) {
    alert('ì‚¬ì§„ì„ ë¨¼ì € ì„ íƒí•˜ì„¸ìš”.');
    return;
  }
  const formData = new FormData();
  formData.append('avatar', selectedFile, selectedFile.name); // â† íŒŒì¼ëª… ëª…ì‹œ

  try {
    const res = await fetch('/api/upload-profile-photo', {
      method: 'POST',
      body: formData,
      credentials: 'include'
    });
    const result = await res.json();
    if (result.success && result.avatarUrl) {
      const preload = new Image();
      preload.onload = () => {
        document.getElementById('profileAvatar').src = result.avatarUrl;
      };
      preload.src = result.avatarUrl;

      alert('í”„ë¡œí•„ ì‚¬ì§„ì´ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤!');
      selectedFile = null;
      document.getElementById('savePhotoBtn').style.display = 'none';
    } else {
      alert('í”„ë¡œí•„ ì‚¬ì§„ ì—…ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
    }
  } catch (err) {
    alert('ì—…ë¡œë“œ ì—ëŸ¬: ' + err);
  }
});

// í˜ì´ì§€ ë– ë‚˜ê¸° ì „ì— ì €ì¥ ì•ˆ í–ˆìœ¼ë©´ ê²½ê³ 
window.addEventListener('beforeunload', function (e) {
  if (selectedFile) {
    e.preventDefault();
    e.returnValue = '';  // í¬ë¡¬/ì‚¬íŒŒë¦¬ì—ì„œ ê¸°ë³¸ ê²½ê³ 
  }
});

document.getElementById('deletePhotoBtn').addEventListener('click', async function() {
  if (!confirm('ì •ë§ í”„ë¡œí•„ ì‚¬ì§„ì„ ê¸°ë³¸ ì´ë¯¸ì§€ë¡œ ë³€ê²½í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
  try {
    const res = await fetch('/api/delete-profile-photo', {
      method: 'DELETE',
      credentials: 'include'
    });
    const result = await res.json();
    if (result.success) {
      document.getElementById('profileAvatar').src = '/icon_my_b.png';
      alert('í”„ë¡œí•„ ì‚¬ì§„ì´ ê¸°ë³¸ ì´ë¯¸ì§€ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.');
      selectedFile = null;
      document.getElementById('savePhotoBtn').style.display = 'none';
    } else {
      alert('í”„ë¡œí•„ ì‚¬ì§„ ì‚­ì œ ì‹¤íŒ¨!');
    }
  } catch (err) {
    alert('ì‚­ì œ ì˜¤ë¥˜: ' + err);
  }
});

/* ê³µí†µ ìœ í‹¸ â€“ ìƒˆ src ê°€ ì ìš©ë¼ ì´ë¯¸ì§€ê°€ ì™„ì „íˆ ë¡œë“œë˜ë©´ í˜ì´ë“œ-ì¸ */
function fadeInAvatar() {
  const av = document.getElementById('profileAvatar');
  av.classList.remove('fade-in');        // ì¬ì‚¬ìš© ëŒ€ë¹„ ë¨¼ì € ì œê±°
  requestAnimationFrame(()=> av.classList.add('fade-in'));
}

/* (1) ì´ˆê¸° í”„ë¡œí•„ ì„¸íŒ… */
const av = document.getElementById('profileAvatar');
av.onload = fadeInAvatar;                // â­ ì´ë¯¸ì§€ê°€ ë¡œë“œë  ë•Œë§ˆë‹¤ ì‹¤í–‰


/* (4) ê¸°ë³¸ ì´ë¯¸ì§€ë¡œ ë˜ëŒë¦´ ë•Œ */
document.getElementById('deletePhotoBtn').addEventListener('click', async()=>{
  /* â€¦ì‚­ì œ ë¡œì§â€¦ */
  av.src = '/icon_my_b.png';             // ì—­ì‹œ onload â†’ í˜ì´ë“œ-ì¸
});

document.getElementById('academy-address-save').onclick = async () => {
  const addr = document.getElementById('mem-academy-address-input').value.trim();
  if (!addr) return alert('ì£¼ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš”.');
  try {
    const res = await fetch('/api/save-academy-address', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      credentials: 'include',
      body: JSON.stringify({ address: addr })
    });
    const d = await res.json();
    if (d.success) {
      document.getElementById('mem-academy-address').textContent = addr;
      alert('ì£¼ì†Œê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
    } else {
      alert('ì €ì¥ ì‹¤íŒ¨');
    }
  } catch (e) {
    alert('ì˜¤ë¥˜ ë°œìƒ');
  }
};

// ë¹„ë°€ë²ˆí˜¸ í™•ì¸ ë²„íŠ¼ ì´ë²¤íŠ¸
document.getElementById('pw-check-btn').onclick = async function() {
  const curPw = document.getElementById('current-password').value;
  if (!curPw) return alert('ê¸°ì¡´ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.');

  // ì„œë²„ì— ë³¸ì¸ ë¹„ë°€ë²ˆí˜¸ í™•ì¸ ìš”ì²­
  const res = await fetch('/api/check-password', {
    method: 'POST',
    headers: {'Content-Type':'application/json'},
    credentials: 'include',
    body: JSON.stringify({ password: curPw })
  });
  const d = await res.json();
  if (d.success) {
    // âœ… ëª¨ë‹¬ ë„ìš°ê¸°
    document.getElementById('pw-modal').style.display = 'flex';
    // ê¸°ì¡´ ì…ë ¥ì¹¸ ìˆ¨ê¸°ê³ , ìƒˆ ë¹„ë°€ë²ˆí˜¸ ì¹¸ ë³´ì´ê¸°ëŠ” ëª¨ë‹¬ ë‹«ì„ ë•Œ ì²˜ë¦¬
  } else {
    alert(d.msg || 'ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
  }
};

// ëª¨ë‹¬ "í™•ì¸" ë²„íŠ¼ í´ë¦­ì‹œ ëª¨ë‹¬ ë‹«ê³  ë‹¤ìŒë‹¨ê³„ ì§„í–‰
document.getElementById('pw-modal-btn').onclick = function() {
  document.getElementById('pw-modal').style.display = 'none';
  // ê¸°ì¡´ ì…ë ¥ì¹¸ ìˆ¨ê¸°ê³ , ìƒˆ ë¹„ë°€ë²ˆí˜¸ ì¹¸ ë³´ì´ê¸°
  document.getElementById('pw-check-box').style.display = 'none';
  document.getElementById('pw-change-box').style.display = 'flex';
};

// ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ë²„íŠ¼ ì´ë²¤íŠ¸
document.getElementById('pw-change-btn').onclick = async function() {
  const newPw = document.getElementById('new-password').value;
  const newPw2 = document.getElementById('confirm-password').value;
  if (!newPw || !newPw2) return alert('ìƒˆ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.');
  if (newPw !== newPw2) return alert('ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');

  const res = await fetch('/api/change-password', {
    method: 'POST',
    headers: {'Content-Type':'application/json'},
    credentials: 'include',
    body: JSON.stringify({ password: newPw })
  });
  const d = await res.json();
  if (d.success) {
    alert('ë¹„ë°€ë²ˆí˜¸ê°€ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤!');
    // ìƒˆ ì…ë ¥ì°½ ë‹«ê¸°, ì…ë ¥ê°’ ì´ˆê¸°í™”
    document.getElementById('pw-change-box').style.display = 'none';
    document.getElementById('pw-check-box').style.display = 'flex';
    document.getElementById('current-password').value = '';
    document.getElementById('new-password').value = '';
    document.getElementById('confirm-password').value = '';
  } else {
    alert(d.msg || 'ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ì‹¤íŒ¨');
  }
};

});
</script>

<!-- [ë¹„ë°€ë²ˆí˜¸ í™•ì¸] ê²°ê³¼ ì•Œë¦¼ ëª¨ë‹¬ -->
<div id="pw-modal" style="display:none;position:fixed;left:0;top:0;width:100vw;height:100vh;z-index:1000;background:rgba(0,0,0,0.35);align-items:center;justify-content:center;">
  <div style="background:#fff;border-radius:14px;padding:36px 28px 22px 28px;min-width:220px;box-shadow:0 8px 24px rgba(0,0,0,.11);text-align:center;">
    <div id="pw-modal-msg" style="font-size:1.13rem;line-height:1.8;margin-bottom:22px;">ë¹„ë°€ë²ˆí˜¸ê°€ í™•ì¸ë˜ì—ˆìŠµë‹ˆë‹¤.</div>
    <button id="pw-modal-btn" style="padding:8px 28px;border:none;background:#6366f1;color:#fff;font-weight:600;font-size:1.05rem;border-radius:8px;cursor:pointer;">í™•ì¸</button>
  </div>
</div>
</div>
</div>
</div>
</div>
</div>
<footer class="site-footer">
  <div class="footer-inner">
    <div class="footer-brand">M.class</div>
    <div>ëŒ€í‘œ: ã…‡ã…‡ã…‡ ì‚¬ì—…ì ë“±ë¡ë²ˆí˜¸: 205-08-14537 í†µì‹ íŒë§¤ë²ˆí˜¸: 2025-ì„œìš¸00-0000</div>
    <div>ì´ë©”ì¼: gh_6399@naver.com ê³ ê°ì„¼í„°: 010-8310-6399</div>
    <div class="copyright">Â© 2025 Mathbee All rights reserved.</div>
  </div>
</footer>

</body>
</html>
