<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>공지사항 글쓰기</title>
  <!-- 만약 CSS 필요하면 (없어도 기본 동작) -->
  <link rel="stylesheet" href="/ckeditor/ckeditor5/ckeditor5.css">
  <style>
    body { font-family: 'Noto Sans KR', sans-serif; margin: 0; padding: 0; background: #fff; }
    .container {
      max-width: 800px;
      margin: 40px auto;
      padding: 32px;
      background: #f8f8f8;
      border-radius: 15px;
      box-shadow: 0 4px 20px #0001;
    }
    h2 { font-size: 2rem; margin-bottom: 28px; font-weight: 900; }
    .row { display: flex; align-items: center; margin-bottom: 18px; }
    label { min-width: 90px; font-weight: 700; }
    select, input[type="text"] {
      font-size: 1rem; padding: 8px 10px; border-radius: 6px; border: 1px solid #bbb; margin-right: 20px;
    }
    #editor { margin-bottom: 24px; min-height: 320px; }
    input[type="file"] { margin-right: 16px; }
    .submit-btn {
      margin-top: 25px;
      background: #2b7aeb;
      color: #fff;
      border: none;
      padding: 13px 40px;
      border-radius: 8px;
      font-size: 1.1rem;
      font-weight: 800;
      cursor: pointer;
      transition: background .14s;
    }
    .submit-btn:hover { background: #2367c7; }
  </style>
</head>
<body>
  <div class="container">
    <h2>공지사항 글쓰기</h2>
    <form id="notice-form" enctype="multipart/form-data" autocomplete="off">
      <div class="row">
        <label for="category">카테고리</label>
        <select id="category" name="category" required>
          <option value="공지">공지사항</option>
          <option value="업데이트">업데이트</option>
          <option value="패치">수정사항</option>
        </select>
        <label for="title">제목</label>
        <input type="text" id="title" name="title" placeholder="제목 입력" required style="width:220px;">
      </div>
      <textarea id="editor"></textarea>
      <div class="row" style="margin-bottom: 10px;">
        <label>이미지</label>
        <input type="file" id="input-img" name="image" accept="image/*">
        <label style="margin-left:50px;">첨부파일</label>
        <input type="file" id="input-file" name="file">
      </div>
      <button type="submit" class="submit-btn">등록</button>
    </form>
  </div>

  <!-- CKEditor5 직접 설치 버전: js 파일 경로! -->
  <script src="/ckeditor/ckeditor5/ckeditor.js"></script>
  <script>
    let ckEditorInstance;
    document.addEventListener('DOMContentLoaded', function () {
      ClassicEditor
        .create(document.querySelector('#editor'), {
          toolbar: [
            'heading', '|', 'bold', 'italic', 'underline', 'strikethrough', '|',
            'fontSize', 'fontColor', 'fontBackgroundColor', '|',
            'bulletedList', 'numberedList', '|', 'link', 'blockQuote', 'insertTable', 'imageUpload', 'undo', 'redo'
          ]
          // 플러그인 등 config 더 넣을 수 있음
        })
        .then(editor => { ckEditorInstance = editor; })
        .catch(error => { console.error('CKEditor5 로딩 오류:', error); });
    });

    document.getElementById('notice-form').onsubmit = function (e) {
      e.preventDefault();
      const category = document.getElementById('category').value;
      const title = document.getElementById('title').value.trim();
      const content = ckEditorInstance.getData();
      const image = document.getElementById('input-img').files[0];
      const file = document.getElementById('input-file').files[0];
      if (!category || !title || !content) {
        alert('카테고리, 제목, 내용을 모두 입력하세요.');
        return;
      }
      alert('[테스트] 제출\n카테고리: ' + category + '\n제목: ' + title + '\n내용(HTML): ' + content.slice(0, 30) + '...');
      // 실제 업로드 시 아래 주석 해제
      /*
      const fd = new FormData();
      fd.append('category', category);
      fd.append('title', title);
      fd.append('content', content);
      if (image) fd.append('image', image);
      if (file) fd.append('file', file);

      fetch('/api/notices', { method: 'POST', body: fd, credentials: 'include' })
        .then(res => res.json())
        .then(data => {
          if (data.msg === '공지 등록 성공') location.href = '/index.html';
          else alert('등록 실패: ' + data.msg);
        });
      */
    };
  </script>
</body>
</html>